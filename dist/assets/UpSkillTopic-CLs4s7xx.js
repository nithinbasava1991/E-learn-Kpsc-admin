import{u as J,r,j as e,M as _,B as y,a as h,G as l,g as q,P as K,I,T as p,F as Q,h as X,S as Y,k as T,l as Z}from"./index-DvYQWpR8.js";import{d as $,T as ee,a as te,b as ae,c as S,e as U,f as se,g as ie,D as re,h as oe,i as le}from"./Add-DE-rMGZW.js";import{h as C}from"./moment-G82_0lEo.js";import{d as de,c as ne}from"./UpskillsCategoryApi-DyppGNYx.js";import{E as ce,D as me}from"./Edit-D3ArGjJU.js";const B=[{id:"topicId",label:"ID"},{id:"topicName",label:"Name",minWidth:100},{id:"description",label:"Description",minWidth:100},{id:"moduleName",label:"Module",minWidth:150},{id:"videoUrl",label:"VideoUrl"},{id:"createdBy",label:"Created By",align:"right"},{id:"updatedBy",label:"Updated By",align:"right"},{id:"insertedDate",label:"Inserted Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],je=()=>{J();const[u,x]=r.useState(0),[d,P]=r.useState(10),[g,f]=r.useState([]),[k,E]=r.useState([]),[M,n]=r.useState(!1),[w,W]=r.useState(!1),[i,j]=r.useState({topicName:"",description:"",moduleId:"",videoUrl:""}),[o,b]=r.useState({}),[v,F]=r.useState(!1),A=(t,s)=>{x(s)},R=t=>{P(+t.target.value),x(0)},N={"Content-type":"application/json",Authorization:"Bearer "+JSON.parse(sessionStorage.getItem("user")).accessToken},H=async()=>{try{const s=(await de(N)).data.content;if(console.log(s),s){const D=s.map(a=>({topicId:a.topicId,topicName:a.topicName,description:a.description,moduleName:a.upskillModuleDtoList?a.upskillModuleDtoList.moduleName:"No Module Name",videoUrl:a.videoUrl,insertedDate:C(a.insertedDate).format("L"),updatedDate:C(a.updatedDate).format("L"),createdBy:a.createdBy?a.createdBy.userName:"No User",updatedBy:a.updatedBy?a.updatedBy.userName:"No User"}));f(D)}else f([])}catch(t){console.error("Error fetching topics:",t)}},L=async()=>{try{const s=(await ne(N)).data.content;if(s){const a=s.sort((m,G)=>m.moduleName.localeCompare(G.moduleName)).map(m=>({moduleId:m.moduleId,moduleName:m.moduleName}));E(a)}}catch(t){console.error("Error fetching modules:",t)}};r.useEffect(()=>{H(),L()},[v]);const z=()=>{const t={};return(!i.topicName||i.topicName.trim()==="")&&(t.topicName="Enter the topic name"),(!i.description||i.description.trim()==="")&&(t.description="Enter the description"),(!i.videoUrl||i.videoUrl.trim()==="")&&(t.videoUrl="Enter the videoUrl"),i.moduleId||(t.moduleId="Select a module"),t},c=t=>{j({...i,[t.target.name]:t.target.value}),b({...o,[t.target.name]:null})},O=()=>{W(!1),j({topicName:"",description:"",moduleId:"",videoUrl:""}),n(!0)},V=()=>{const t=z();Object.keys(t).length===0?(n(!1),F(!v)):b(t)};return e.jsxs(_,{title:e.jsxs(y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Upskills Topics"}),e.jsxs(h,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:O,children:["Add",e.jsx($,{sx:{color:"#fff"}})]})]}),children:[e.jsx(l,{container:!0,spacing:q}),e.jsxs(K,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(ee,{sx:{maxHeight:440},children:e.jsxs(te,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(ae,{children:e.jsx(S,{children:B.map(t=>e.jsx(U,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(se,{children:g.slice(u*d,u*d+d).map(t=>e.jsx(S,{hover:!0,role:"checkbox",tabIndex:-1,children:B.map(s=>e.jsx(U,{align:s.align,children:s.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(I,{color:"primary",children:e.jsx(ce,{})}),e.jsx(I,{color:"error",children:e.jsx(me,{})})]}):t[s.id]||"No Data"},s.id))},t.topicId))})]})}),e.jsx(ie,{rowsPerPageOptions:[10,25,100],component:"div",count:g.length,rowsPerPage:d,page:u,onPageChange:A,onRowsPerPageChange:R})]}),e.jsxs(re,{open:M,onClose:()=>n(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(oe,{sx:{fontSize:"16px"},children:w?"Edit Topic":"Add Topic"}),e.jsxs(y,{component:"form",noValidate:!0,sx:{p:3},onSubmit:t=>{t.preventDefault(),V()},children:[e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Topic Name",name:"topicName",value:i.topicName,onChange:c,error:!!o.topicName,helperText:o.topicName})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Description",name:"description",value:i.description,onChange:c,error:!!o.description,helperText:o.description,multiline:!0,rows:3})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(Q,{fullWidth:!0,error:!!o.moduleId,children:[e.jsx(X,{id:"module-select",children:"Module"}),e.jsxs(Y,{labelId:"module-select",name:"moduleId",value:i.moduleId,onChange:c,children:[e.jsx(T,{value:"",children:e.jsx("em",{children:"None"})}),k.map(t=>e.jsx(T,{value:t.moduleId,children:t.moduleName},t.moduleId))]}),e.jsx(Z,{children:o.moduleId})]})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"VideoUrl ",name:"videoUrl",value:i.videoUrl,onChange:c,error:!!o.videoUrl,helperText:o.videoUrl})})]}),e.jsxs(le,{children:[e.jsx(h,{onClick:()=>n(!1),children:"Cancel"}),e.jsx(h,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})]})]})]})};export{je as default};
