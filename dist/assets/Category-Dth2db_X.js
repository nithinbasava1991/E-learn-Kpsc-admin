import{r as d,j as e,M as X,B as v,a as C,G as n,g as Y,P as Z,I as U,T as c,F as $,h as ee,S as te,k as re}from"./index-DvYQWpR8.js";import{h as E}from"./moment-G82_0lEo.js";import{d as oe,T as ae,a as ie,b as se,c as S,e as B,f as ne,g as le,D as de,h as ce,i as ge}from"./Add-DE-rMGZW.js";import{c as ue,e as me,g as he,h as Pe,i as ye,j as xe}from"./kpscApi-DHTzs8Ro.js";import{E as pe,D as je}from"./Edit-D3ArGjJU.js";const W=[{id:"categoryId",label:"ID",align:"center"},{id:"categoryName",label:"Name",align:"center"},{id:"description",label:"Description",minWidth:100,align:"center"},{id:"jobPostName",label:"Job Post",align:"center"},{id:"categoryMrp",label:"Mrp",align:"center"},{id:"discount",label:"Discount",align:"center"},{id:"sellingPrice",label:"SellingPrice",align:"center"},{id:"gst",label:"GST",align:"center"},{id:"gstAmount",label:"GST Amount",align:"center"},{id:"trailPeriod",label:"TrailPeriod",align:"center"},{id:"activePeriod",label:"activePeriod",align:"center"},{id:"videoUrl",label:"videoUrl",align:"center"},{id:"createdBy",label:"Created By",align:"center"},{id:"updatedBy",label:"Updated By",align:"center"},{id:"insertedDate",label:"Inserted Date",align:"center"},{id:"updatedDate",label:"Updated Date",align:"center"},{id:"actions",label:"Actions",align:"center"}],Ne=()=>{const[y,I]=d.useState(0),[h,w]=d.useState(10),[N,D]=d.useState([]),[F,g]=d.useState(!1),[x,p]=d.useState(!1),[t,j]=d.useState({categoryName:"",description:"",jobPostId:"",categoryMrp:"",discount:"",sellingPrice:"",gst:"",gstAmount:"",trailPeriod:"",activePeriod:"",videoUrl:""}),[a,A]=d.useState({}),[b,T]=d.useState(!1),[k,M]=d.useState(null),[L,R]=d.useState([]),G=(r,i)=>{I(i)},J=r=>{w(+r.target.value),I(0)},f=JSON.parse(sessionStorage.getItem("user")),u={"Content-type":"application/json",Authorization:"Bearer "+f.accessToken},m=async()=>{try{const i=(await me(u)).data.content;if(i){const s=i.map(o=>({categoryId:o.categoryId,categoryName:o.categoryName,description:o.description,jobPostName:o.jobPostDtoList?o.jobPostDtoList.jobPostName:"Not Found",categoryMrp:o.categoryMrp?o.categoryMrp:"Not Found",discount:o.discount?o.discount:"Not Found",sellingPrice:o.sellingPrice?o.sellingPrice:"Not Found",gst:o.gst?o.gst:"Not Found",gstAmount:o.gstAmount?o.gstAmount:"Not Found",trailPeriod:o.trailPeriod,activePeriod:o.activePeriod,videoUrl:o.videoUrl?o.videoUrl:"Not Found",insertedDate:E(o.insertedDate).format("L"),updatedDate:E(o.updatedDate).format("L"),createdBy:o.createdBy?o.createdBy.userName:"No User",updatedBy:o.updatedBy?o.updatedBy.userName:"No User"}));D(s)}else D([])}catch(r){console.error("Error fetching data:",r)}};d.useEffect(()=>{m(),V()},[b]);const z=()=>{const r={};return(!t.categoryName||t.categoryName.trim()==="")&&(r.categoryName="Enter the category name"),(!t.description||t.description.trim()==="")&&(r.description="Enter the description"),(!t.categoryMrp||t.categoryMrp.trim()==="")&&(r.categoryMrp="Enter the category Mrp"),(!t.discount||t.discount.trim()==="")&&(r.discount="Enter the discount"),(!t.sellingPrice||t.sellingPrice.trim()==="")&&(r.sellingPrice="Enter the sellingPrice"),(!t.gst||t.gst.trim()==="")&&(r.gst="Enter the gst"),(!t.gstAmount||t.gstAmount.trim()==="")&&(r.gstAmount="Enter the gstAmount"),(!t.trailPeriod||t.trailPeriod.trim()==="")&&(r.trailPeriod="Enter the trailPeriod"),(!t.activePeriod||t.activePeriod.trim()==="")&&(r.activePeriod="Enter the activePeriod"),(!t.videoUrl||t.videoUrl.trim()==="")&&(r.videoUrl="Enter the videoUrl"),r},l=r=>{j({...t,[r.target.name]:r.target.value}),A({...a,[r.target.name]:null})},H=()=>{p(!1),j({categoryName:"",description:"",jobPostId:"",categoryMrp:"",discount:"",sellingPrice:"",gst:"",gstAmount:"",trailPeriod:"",activePeriod:"",videoUrl:""}),g(!0)},O=async r=>{p(!0),g(!0);try{const s=(await he(r,u)).data;console.log(s),M(s.categoryId),j({categoryName:s.categoryName,description:s.description,categoryMrp:s.categoryMrp,discount:s.discount,sellingPrice:s.sellingPrice,gst:s.gst,gstAmount:s.gstAmount,trailPeriod:s.trailPeriod,activePeriod:s.activePeriod,videoUrl:s.videoUrl,jobPostId:s.jobPostDtoList?s.jobPostDtoList.jobPostId:""})}catch(i){console.error("Error fetching category details:",i)}},V=async()=>{try{const i=(await ue(u)).data;if(console.log(i),i){const o=i.sort((P,Q)=>P.jobPostName.localeCompare(Q.jobPostName)).map(P=>({jobPostId:P.jobPostId,jobPostName:P.jobPostName}));R(o)}}catch(r){console.error("Error fetching jobPosts:",r)}},_=async r=>{r.preventDefault();const i=z();if(Object.keys(i).length>0){A(i);return}const s={categoryName:t.categoryName,activePeriod:t.activePeriod,categoryMrp:t.categoryMrp,discount:t.discount,gst:t.gst,gstAmount:t.gstAmount,sellingPrice:t.sellingPrice,trailPeriod:t.trailPeriod,description:t.description,videoUrl:t.videoUrl,jobPostDtoList:{jobPostId:t.jobPostId},createdBy:{userId:f.userId}};console.log(s);try{const o=await Pe(s,u);console.log(o),o.data.responseCode===201?(T(!b),g(!1),m()):alert(o.data.errorMessage)}catch{}m(),g(!1)},q=async r=>{r.preventDefault();const i={categoryId:k,categoryName:t.categoryName,description:t.description,categoryMrp:t.categoryMrp,discount:t.discount,sellingPrice:t.sellingPrice,gst:t.gst,gstAmount:t.gstAmount,trailPeriod:t.trailPeriod,activePeriod:t.activePeriod,videoUrl:t.videoUrl,jobPostDtoList:{jobPostId:t.jobPostId},updatedBy:{userId:f.userId}};try{(await ye(i,u)).data.responseCode===201&&(T(!b),g(!1),p(!1),M(null))}catch(s){console.error("Error updating category:",s)}m(),g(!1)},K=async r=>{try{await xe(r,u),m()}catch(i){console.error("Error deleting category:",i)}};return e.jsxs(X,{title:e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Category"}),e.jsxs(C,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:H,children:["Add",e.jsx(oe,{sx:{color:"#fff"}})]})]}),children:[e.jsx(n,{container:!0,spacing:Y}),e.jsxs(Z,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(ae,{sx:{maxHeight:440},children:e.jsxs(ie,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(se,{children:e.jsx(S,{children:W.map(r=>e.jsx(B,{align:r.align,style:{minWidth:r.minWidth,fontWeight:600,fontSize:15},children:r.label},r.id))})}),e.jsx(ne,{children:N.slice(y*h,y*h+h).map(r=>e.jsx(S,{hover:!0,role:"checkbox",tabIndex:-1,children:W.map(i=>e.jsx(B,{align:i.align,children:i.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(U,{color:"primary",onClick:()=>{O(r.categoryId)},children:e.jsx(pe,{})}),e.jsx(U,{color:"error",onClick:()=>{K(r.categoryId)},children:e.jsx(je,{})})]}):r[i.id]},i.id))},r.categoryId))})]})}),e.jsx(le,{rowsPerPageOptions:[10,25,100],component:"div",count:N.length,rowsPerPage:h,page:y,onPageChange:G,onRowsPerPageChange:J})]}),e.jsxs(de,{open:F,onClose:()=>g(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(ce,{sx:{fontSize:"16px"},children:x?"Edit Category":"Add Category"}),e.jsxs(v,{component:"form",onSubmit:x?q:_,noValidate:!0,sx:{p:3},children:[e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(c,{fullWidth:!0,label:"Category Name",name:"categoryName",value:t.categoryName,onChange:l,error:!!a.categoryName,helperText:a.categoryName})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(c,{fullWidth:!0,label:"Description",name:"description",value:t.description,onChange:l,error:!!a.description,helperText:a.description,multiline:!0,rows:3})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs($,{fullWidth:!0,error:!!a.jobPostId,sx:{mb:2},children:[e.jsx(ee,{children:"Job Post"}),e.jsx(te,{name:"jobPostId",value:t.jobPostId,onChange:l,label:"jobPostName",children:L.map(r=>e.jsx(re,{value:r.jobPostId,children:r.jobPostName},r.jobPostId))}),a.jobPostId&&e.jsx(v,{component:"span",sx:{color:"error.main",fontSize:"0.75rem",mt:1},children:a.jobPostId})]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(c,{fullWidth:!0,label:"MRP",name:"categoryMrp",value:t.categoryMrp,onChange:l,error:!!a.categoryMrp,helperText:a.categoryMrp})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(c,{fullWidth:!0,label:"Discount",name:"discount",value:t.discount,onChange:l,error:!!a.discount,helperText:a.discount})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(c,{fullWidth:!0,label:"Selling Price",name:"sellingPrice",value:t.sellingPrice,onChange:l,error:!!a.sellingPrice,helperText:a.sellingPrice})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(c,{fullWidth:!0,label:"GST",name:"gst",value:t.gst,onChange:l,error:!!a.gst,helperText:a.gst})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(c,{fullWidth:!0,label:"GST Amount",name:"gstAmount",value:t.gstAmount,onChange:l,error:!!a.gstAmount,helperText:a.gstAmount})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(c,{fullWidth:!0,label:"Trail Period",name:"trailPeriod",value:t.trailPeriod,onChange:l,error:!!a.trailPeriod,helperText:a.trailPeriod})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(c,{fullWidth:!0,label:"Active Period",name:"activePeriod",value:t.activePeriod,onChange:l,error:!!a.activePeriod,helperText:a.activePeriod})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(c,{fullWidth:!0,label:"VideoUrl ",name:"videoUrl",value:t.videoUrl,onChange:l,error:!!a.videoUrl,helperText:a.videoUrl})})]}),e.jsxs(ge,{sx:{mt:2},children:[e.jsx(C,{type:"submit",variant:"contained",color:"primary",children:x?"Update":"Add"}),e.jsx(C,{onClick:()=>g(!1),children:"Cancel"})]})]})]})]})};export{Ne as default};
