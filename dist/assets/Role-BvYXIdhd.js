import{u as F,r,j as e,M as H,B,a as h,G as g,g as M,P as O,I as D,T as G}from"./index-DvYQWpR8.js";import{h as I}from"./moment-G82_0lEo.js";import{d as L,T as J,a as V,b as _,c as N,e as C,f as q,g as K,D as Q,h as X,i as Y}from"./Add-DE-rMGZW.js";import{g as Z}from"./kpscApi-DHTzs8Ro.js";import{a as $}from"./RoleApi-DFSzNHn1.js";import{E as ee,D as ae}from"./Edit-D3ArGjJU.js";const P=[{id:"roleId",label:"ID",align:"center"},{id:"roleName",label:"Name",align:"center"},{id:"createdBy",label:"Created By",align:"center"},{id:"updatedBy",label:"Updated By",align:"center"},{id:"insertedDate",label:"Inserted Date",align:"center"},{id:"updatedDate",label:"Updated Date",align:"center"},{id:"actions",label:"Actions",align:"center"}],ce=()=>{F();const[i,x]=r.useState(0),[o,T]=r.useState(10),[m,u]=r.useState([]),[S,l]=r.useState(!1),[p,f]=r.useState(!1),[j,d]=r.useState({roleName:"",description:""}),[c,R]=r.useState({}),[E,te]=r.useState(!1),[re,v]=r.useState(null),w=(a,t)=>{x(t)},k=a=>{T(+a.target.value),x(0)},y=JSON.parse(sessionStorage.getItem("user")),b={"Content-type":"application/json",Authorization:"Bearer "+y.accessToken},A=async()=>{try{const t=(await $(b)).data.content;if(console.log(t),t){const n=t.map(s=>({roleId:s.roleId,roleName:s.roleName,insertedDate:I(s.insertedDate).format("L"),updatedDate:I(s.updatedDate).format("L"),createdBy:s.createdBy?s.createdBy.userName:"No User",updatedBy:s.updatedBy?s.updatedBy.userName:"No User"}));u(n)}else u([])}catch(a){console.error("Error fetching data:",a)}};r.useEffect(()=>{A()},[E]);const U=a=>{d({...j,[a.target.name]:a.target.value,createdBy:{userId:y.userId}}),R({...c,[a.target.name]:null})},W=()=>{f(!1),d({roleName:"",description:""}),l(!0)},z=async a=>{f(!0),l(!0);try{const n=(await Z(a,b)).data;v(n.roleId),d({roleName:n.roleName,description:n.description})}catch(t){console.error("Error fetching role details:",t)}};return e.jsxs(H,{title:e.jsxs(B,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Role"}),e.jsxs(h,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:W,children:["Add",e.jsx(L,{sx:{color:"#fff"}})]})]}),children:[e.jsx(g,{container:!0,spacing:M}),e.jsxs(O,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(J,{sx:{maxHeight:440},children:e.jsxs(V,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(_,{children:e.jsx(N,{children:P.map(a=>e.jsx(C,{align:a.align,style:{minWidth:a.minWidth,fontWeight:600,fontSize:15},children:a.label},a.id))})}),e.jsx(q,{children:m.slice(i*o,i*o+o).map(a=>e.jsx(N,{hover:!0,role:"checkbox",tabIndex:-1,children:P.map(t=>e.jsx(C,{align:t.align,children:t.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(D,{onClick:()=>z(a.roleId),color:"primary",children:e.jsx(ee,{})}),e.jsx(D,{color:"error",children:e.jsx(ae,{})})]}):a[t.id]},t.id))},a.roleId))})]})}),e.jsx(K,{rowsPerPageOptions:[10,25,100],component:"div",count:m.length,rowsPerPage:o,page:i,onPageChange:w,onRowsPerPageChange:k})]}),e.jsxs(Q,{open:S,onClose:()=>l(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(X,{sx:{fontSize:"16px"},children:p?"Edit Role":"Add Role"}),e.jsxs(B,{component:"form",noValidate:!0,sx:{p:3},children:[e.jsx(g,{container:!0,spacing:2,children:e.jsx(g,{item:!0,xs:12,children:e.jsx(G,{fullWidth:!0,label:"Role Name",name:"roleName",value:j.roleName,onChange:U,error:!!c.roleName,helperText:c.roleName})})}),e.jsxs(Y,{children:[e.jsx(h,{type:"submit",variant:"contained",color:"primary",children:p?"Update":"Add"}),e.jsx(h,{onClick:()=>l(!1),children:"Cancel"})]})]})]})]})};export{ce as default};
