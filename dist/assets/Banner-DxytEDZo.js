import{u as Z,r as s,j as e,M as ee,B as P,a as u,G as m,g as te,P as ae,I as T,T as x,b as re,c as w}from"./index-DvYQWpR8.js";import{f as se,u as ne,a as ie,g as le,d as de}from"./BannerApi-CxFl_isZ.js";import{h as A}from"./moment-G82_0lEo.js";import{d as oe,T as ce,a as me,b as fe,c as F,e as k,f as he,g as ue,D as pe,h as ge,i as xe}from"./Add-DE-rMGZW.js";import{E as ve,D as Ne}from"./Edit-D3ArGjJU.js";const U=[{id:"advertisementId",label:"ID",align:"center"},{id:"advertisementName",label:"Name",align:"center"},{id:"description",label:"Description",minWidth:100,align:"center"},{id:"file",label:"File",align:"center"},{id:"createdBy",label:"Created By",align:"center"},{id:"updatedBy",label:"Updated By",align:"center"},{id:"insertedDate",label:"Inserted Date",align:"center"},{id:"updatedDate",label:"Updated Date",align:"center"},{id:"actions",label:"Actions",align:"center"}],Se=()=>{Z();const[p,v]=s.useState(0),[f,W]=s.useState(10),[N,j]=s.useState([]),[R,d]=s.useState(!1),[g,y]=s.useState(!1),[n,o]=s.useState({advertisementName:"",description:"",fileName:""}),[l,b]=s.useState({}),[je,D]=s.useState(""),[ye,B]=s.useState(""),[I,M]=s.useState(null),[O,z]=s.useState(!1),[H,G]=s.useState(null),C=s.useRef(null),L=(t,a)=>{v(a)},$=t=>{W(+t.target.value),v(0)},h=JSON.parse(sessionStorage.getItem("user")),c={"Content-type":"application/json",Authorization:"Bearer "+h.accessToken},J=`${w}/file/downloadFile/?filePath=`,S=async()=>{try{const a=(await se(c)).data.content;if(a){const r=a.map(i=>({advertisementId:i.advertisementId,advertisementName:i.advertisementName,description:i.description,file:i.filePath===null?"NO IMAGE FOUND":e.jsx("img",{src:J+i.filePath,alt:i.fileName,style:{width:100,height:50}}),insertedDate:A(i.insertedDate).format("L"),updatedDate:A(i.updatedDate).format("L"),createdBy:i.createdBy?i.createdBy.userName:"No User",updatedBy:i.updatedBy?i.updatedBy.userName:"No User"}));j(r)}else j([])}catch(t){console.error("Error fetching data:",t)}};s.useEffect(()=>{S()},[O]);const V=async t=>{t.preventDefault();const a=K();if(Object.keys(a).length>0)b(a);else{try{if(g){const r={...n,advertisementId:H,updatedBy:{userId:h.userId}};await ne(r,c)}else await ie(n,c);o({advertisementName:"",description:"",fileName:""}),C.current.value=null,z(r=>!r),d(!1)}catch(r){console.error("Error saving advertisement:",r)}fetchData(),d(!1)}},_=async t=>{if(t.preventDefault(),!I){D("Please select a file");return}const a=new FormData;a.append("file",I);try{const r=await re.post(`${w}/file/uploadFile`,a,{headers:{"content-type":"multipart/form-data",Authorization:"Bearer "+h.accessToken}});B(r.data.fileName),alert(r.data.message),o({...n,fileName:r.data.fileName}),D("")}catch(r){console.log("Error uploading file:",r),alert(r.res.data.errorMessage)}},q=t=>{B(t.target.files[0].name),M(t.target.files[0])},K=()=>{const t={};return(!n.advertisementName||n.advertisementName.trim()==="")&&(t.advertisementName="Enter the Advertisement name"),(!n.description||n.description.trim()==="")&&(t.description="Enter the description"),(!n.fileName||n.fileName.trim()==="")&&(t.fileName="Select the file"),t},E=t=>{o({...n,[t.target.name]:t.target.value,createdBy:{userId:h.userId}}),b({...l,[t.target.name]:null})},Q=()=>{y(!1),o({advertisementName:"",description:"",fileName:""}),d(!0)},X=async t=>{y(!0),d(!0);try{const r=(await le(t,c)).data;G(r.advertisementId),o({advertisementName:r.advertisementName,description:r.description,fileName:r.fileName})}catch(a){console.error("Error fetching advertisement details:",a)}},Y=async t=>{try{await de(t,c),S()}catch(a){console.error("Error deleting advertisement:",a)}};return e.jsxs(ee,{title:e.jsxs(P,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Banner"}),e.jsxs(u,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:Q,children:["Add",e.jsx(oe,{sx:{color:"#fff"}})]})]}),children:[e.jsx(m,{container:!0,spacing:te}),e.jsxs(ae,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(ce,{sx:{maxHeight:440},children:e.jsxs(me,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(fe,{children:e.jsx(F,{children:U.map(t=>e.jsx(k,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(he,{children:N.slice(p*f,p*f+f).map(t=>e.jsx(F,{hover:!0,role:"checkbox",tabIndex:-1,children:U.map(a=>e.jsx(k,{align:a.align,children:a.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(T,{onClick:()=>X(t.advertisementId),color:"primary",children:e.jsx(ve,{})}),e.jsx(T,{onClick:()=>Y(t.advertisementId),color:"error",children:e.jsx(Ne,{})})]}):t[a.id]},a.id))},t.advertisementId))})]})}),e.jsx(ue,{rowsPerPageOptions:[10,25,100],component:"div",count:N.length,rowsPerPage:f,page:p,onPageChange:L,onRowsPerPageChange:$})]}),e.jsxs(pe,{open:R,onClose:()=>d(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(ge,{sx:{fontSize:"16px"},children:g?"Edit Advertisement":"Add Advertisement"}),e.jsxs(P,{component:"form",onSubmit:V,noValidate:!0,sx:{p:3},children:[e.jsxs(m,{container:!0,spacing:2,children:[e.jsx(m,{item:!0,xs:12,children:e.jsx(x,{fullWidth:!0,label:"Advertisement Name",name:"advertisementName",value:n.advertisementName,onChange:E,error:!!l.advertisementName,helperText:l.advertisementName})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(x,{fullWidth:!0,label:"Description",name:"description",value:n.description,onChange:E,error:!!l.description,helperText:l.description,multiline:!0,rows:3})}),e.jsxs(m,{item:!0,xs:12,children:[e.jsx(x,{margin:"normal",fullWidth:!0,id:"fileName",label:"File Name",name:"fileName",autoComplete:"fileName",value:n.fileName,disabled:!0,helperText:l.fileName,error:!!l.fileName,InputProps:{endAdornment:e.jsx(u,{variant:"contained",color:"primary",onClick:_,children:"Upload"})}}),e.jsx("input",{type:"file",onChange:q,ref:C,style:{marginTop:20}})]})]}),e.jsxs(xe,{children:[e.jsx(u,{onClick:()=>d(!1),children:"Cancel"}),e.jsx(u,{type:"submit",variant:"contained",color:"primary",children:g?"Update":"Save"})]})]})]})]})};export{Se as default};
