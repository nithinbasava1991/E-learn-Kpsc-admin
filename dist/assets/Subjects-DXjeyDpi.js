import{r,u as U,j as s,M as z,T as o,G as A,C as d,e as u,f as h,b as J,a as G}from"./index-BHN5gOPI.js";import{I as L}from"./InfoOutlined-CYAz9j-c.js";const q=()=>{const[x,i]=r.useState([]),[f,k]=r.useState(!1),[y,B]=r.useState(null),[c,v]=r.useState(null),[S,l]=r.useState([]),[w,p]=r.useState(null),[I,a]=r.useState([]),M=U(),{jobPostId:b,jobPostName:D,details:j}=M.state||{},m={"Content-type":"application/json",Authorization:"Bearer "+JSON.parse(sessionStorage.getItem("user")).accessToken};r.useEffect(()=>{Array.isArray(j)?i(j):b&&T()},[b,j]);const T=async()=>{try{const t=await(await fetch(`https://virtullearning.cloudjiffy.net/elearnkpsuser/subject/v1/getSubjectsByJobPostId/{jobPostId}?jobPostId=${b}`,{headers:m})).json();Array.isArray(t)?i(t):(console.error("Expected an array, got:",t),i([]))}catch(e){console.error("Error fetching subjects:",e),i([])}},E=async e=>{try{const n=await(await fetch(`https://virtullearning.cloudjiffy.net/elearnkpsuser/module/v1/getModulesBySubjectId/{subjectId}?subjectId=${e}`,{headers:m})).json();if(Array.isArray(n)){const N=n.map(g=>({...g,moduleName:g.moduleName||"No name available.",description:g.description||"No description available."}));l(N),console.log("Modules state updated:",N)}else console.error("Expected an array, but got:",n),l([])}catch(t){console.error("Error fetching modules:",t),l([])}},P=async e=>{try{const t=await G.get(`https://virtullearning.cloudjiffy.net/elearnkpsuser/topic/v1/getAllTopicByPagination/0/10/${e}?moduleId=${e}&pageNumber=0&pageSize=10`,{headers:m});t.data&&Array.isArray(t.data.content)?a(t.data.content):(console.error("Expected an array for topics, but got:",t.data),a([]))}catch(t){console.error("Error fetching topics:",t),a([])}},$=()=>k(!0),F=(e,t)=>{e.stopPropagation(),B(y===t?null:t)},V=e=>{v(e),console.log("Fetching modules for subjectId:",e.subjectId),E(e.subjectId)},R=e=>{p(e),console.log("Fetching topics for moduleId:",e.moduleId),P(e.moduleId)},C=e=>{e==="subject"?(v(null),l([]),p(null),a([])):e==="module"&&(p(null),a([]))};return s.jsxs(s.Fragment,{children:[s.jsx(z,{children:s.jsxs(o,{variant:"h3",gutterBottom:!0,children:["Subject Details for ",D||"Selected Job Post"]})}),s.jsx(A,{container:!0,spacing:2,children:(f?x:x.slice(0,4)).map((e,t)=>s.jsx(A,{item:!0,xs:12,sm:6,md:4,lg:4,children:s.jsx(d,{sx:{border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out","&:hover":{transform:"scale(1.03)",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.2)",cursor:"pointer"}},onClick:()=>V(e),children:s.jsxs(u,{children:[e.videoUrl&&s.jsx("iframe",{title:"YouTube Video",src:`https://www.youtube.com/embed/${e.videoUrl}`,frameBorder:"0",allowFullScreen:!0,style:{width:"100%",height:"190px",marginBottom:"1rem"}}),s.jsxs(o,{variant:"h4",sx:{mb:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.subjectName,s.jsx(h,{sx:{borderRadius:"50%",backgroundColor:"transparent",minWidth:"unset",padding:"8px","&:hover":{backgroundColor:"action.hover"}},onClick:n=>F(n,e.subjectId),children:s.jsx(L,{sx:{fontSize:24}})})]}),y===e.subjectId&&s.jsx(o,{variant:"body2",sx:{mt:1},children:e.description?e.description:"No description available for this subject."})]})})},e.subjectId||t))}),x.length>4&&!f&&s.jsx(J,{sx:{textAlign:{sm:"right",xs:"center"},mt:2},children:s.jsx(h,{variant:"contained",color:"primary",onClick:$,children:"View All"})}),c&&s.jsx(d,{sx:{mt:4,padding:2},children:s.jsxs(u,{children:[s.jsx(o,{variant:"h5",children:c.subjectName}),s.jsx(o,{variant:"body1",sx:{mb:2},children:c.description?c.description:"No description available for this subject."}),s.jsx(o,{variant:"h6",sx:{mb:2},children:"Modules:"}),S.length>0?s.jsx("ul",{style:{listStyleType:"none",paddingLeft:0},children:S.map(e=>s.jsx("li",{children:s.jsx(d,{sx:{border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out","&:hover":{transform:"scale(1.03)",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.2)",cursor:"pointer"}},onClick:()=>R(e),children:s.jsxs(u,{children:[s.jsx(o,{variant:"h6",children:e.moduleName}),s.jsx(o,{variant:"body2",children:e.description||"No description available."})]})})},e.moduleId))}):s.jsx(o,{variant:"body2",color:"textSecondary",children:"No modules available for this subject."}),s.jsx(h,{variant:"outlined",color:"secondary",onClick:()=>C("subject"),children:"Close"})]})}),w&&s.jsx(d,{sx:{mt:4,padding:2},children:s.jsxs(u,{children:[s.jsx(o,{variant:"h5",children:w.moduleName}),s.jsx(o,{variant:"h6",sx:{mb:2},children:"Topics:"}),I.length>0?s.jsx("ul",{children:I.map(e=>s.jsxs("li",{children:[s.jsx(o,{variant:"h6",children:e.topicName}),s.jsx(o,{variant:"body2",children:e.description||"No description available."}),e.videoUrl&&s.jsx("iframe",{title:"Topic Video",src:`https://www.youtube.com/embed/${e.videoUrl}`,frameBorder:"0",allowFullScreen:!0,style:{width:"100%",height:"190px",marginBottom:"1rem"}})]},e.topicId))}):s.jsx(o,{variant:"body2",color:"textSecondary",children:"No topics available for this module."}),s.jsx(h,{variant:"outlined",color:"secondary",onClick:()=>C("module"),children:"Close"})]})})]})};export{q as default};
