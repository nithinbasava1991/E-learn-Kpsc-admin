import{b as p,c as g,u as L,r as l,j as a,M as J,B as T,a as b,G as _,g as K,P as V,I as P,T as E}from"./index-DvYQWpR8.js";import{h as w}from"./moment-G82_0lEo.js";import{d as X,T as Y,a as Z,b as ee,c as S,e as Q,f as ae,g as te,D as ie,h as re,i as ne}from"./Add-DE-rMGZW.js";import{E as se,D as oe}from"./Edit-D3ArGjJU.js";import{C as ce}from"./Container-C8ptew7M.js";const le=async(s,o)=>{try{const t=await p({method:"POST",url:`${g}/qualification/v1/createQualification`,headers:o,data:JSON.stringify(s)});console.log(t),t.data.responseCode===201?alert(t.data.message):alert(t.data.errorMessage||"An error occurred")}catch(t){alert(t.message||"An unexpected error occurred")}},de=async s=>{try{return(await p.get(`${g}/qualification/v1/getAllQualificationByPagination/{pageNumber}/{pageSize}?pageNumber=0&pageSize=10`,{headers:s})).data}catch(o){throw o}},ue=async(s,o)=>await p({method:"GET",url:`${g}/qualification/v1/getQualificationByQualificationId/{qualificationId}?qualificationId=${o}`,headers:s}),fe=async(s,o)=>{try{const t=await p({method:"PUT",url:`${g}/qualification/v1/updateQualification`,headers:o,data:s});t.data.responseCode===201?alert(t.data.message):t.data.responseCode===400?alert(t.data.errorMessage):alert("Unexpected response code")}catch(t){console.error("Error updating promo:",t)}},pe=async(s,o)=>{await p({method:"DELETE",url:`${g}/qualification/v1/deleteQualificationById/${o}`,headers:s}).then(t=>{t.data.responseCode===200?alert(t.data.message):t.data.responseCode===400&&alert(t.data.errorMessage)}).catch(t=>{console.log(t)})},k=[{id:"qualificationId",label:"ID",align:"center"},{id:"qualificationName",label:"Name",align:"center"},{id:"description",label:"Description",minWidth:100,align:"center"},{id:"createdBy",label:"Created By",align:"center"},{id:"updatedBy",label:"Updated By",align:"center"},{id:"insertedDate",label:"Created Date",align:"center"},{id:"updatedDate",label:"Modified Date",align:"center"},{id:"actions",label:"Actions",align:"center"}],je=()=>{L();const[s,o]=l.useState(0),[t,A]=l.useState(10),[C,D]=l.useState([]),[U,d]=l.useState(!1),[x,y]=l.useState(!1),[c,j]=l.useState({qualificationName:"",description:""}),[u,N]=l.useState({}),[q,B]=l.useState(!1),[M,I]=l.useState(null),O=(e,i)=>{o(i)},$=e=>{A(+e.target.value),o(0)},h=JSON.parse(sessionStorage.getItem("user")),f={"Content-type":"application/json",Authorization:"Bearer "+h.accessToken},m=async()=>{try{const e=await de(f);console.log(e.content);const i=e.content;if(i){const r=i.map(n=>({qualificationId:n.qualificationId,qualificationName:n.qualificationName,description:n.description,insertedDate:w(n.insertedDate).format("L"),updatedDate:w(n.updatedDate).format("L"),createdBy:n.createdBy?n.createdBy.userName:"No User",updatedBy:n.updatedBy?n.updatedBy.userName:"No User"}));D(r)}else D([])}catch(e){console.error("Error fetching data:",e)}};l.useEffect(()=>{m()},[q]);const R=()=>{const e={};return(!c.qualificationName||c.qualificationName.trim()==="")&&(e.qualificationName="Enter the qualification name"),(!c.description||c.description.trim()==="")&&(e.description="Enter the description"),e},v=e=>{j({...c,[e.target.name]:e.target.value,createdBy:{userId:h.userId}}),N({...u,[e.target.name]:null})},W=()=>{y(!1),j({qualificationName:"",description:""}),d(!0)},F=async e=>{y(!0),d(!0);try{const i=await ue(f,e);console.log(i.data);const r=i.data;I(r.qualificationId),j({qualificationName:r.qualificationName,description:r.description})}catch(i){console.error("Error fetching qualification details:",i)}},z=async e=>{e.preventDefault();const i=R();if(Object.keys(i).length>0){N(i);return}const r={qualificationName:c.qualificationName,description:c.description,createdBy:{userId:h.userId}};try{(await le(r,f)).data.responseCode===201&&(B(!q),d(!1))}catch(n){console.log(n)}m(),d(!1)},H=async e=>{e.preventDefault();const i={qualificationId:M,qualificationName:c.qualificationName,description:c.description,updatedBy:{userId:h.userId}};try{const r=await fe(i,f);console.log(r),r.data.responseCode===201&&(B(!q),d(!1),y(!1),I(null))}catch(r){console.error(r)}m(),d(!1)},G=async e=>{try{await pe(f,e),m()}catch(i){console.error("Error deleting qualification:",i)}};return a.jsxs(J,{title:a.jsxs(T,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:"Qualification"}),a.jsxs(b,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:W,children:["Add",a.jsx(X,{sx:{color:"#fff"}})]})]}),children:[a.jsx(_,{container:!0,spacing:K}),a.jsxs(V,{sx:{width:"100%",overflow:"hidden"},children:[a.jsx(Y,{sx:{maxHeight:440},children:a.jsxs(Z,{stickyHeader:!0,"aria-label":"sticky table",children:[a.jsx(ee,{children:a.jsx(S,{children:k.map(e=>a.jsx(Q,{align:e.align,style:{minWidth:e.minWidth,fontWeight:600},children:e.label},e.id))})}),a.jsx(ae,{children:C.slice(s*t,s*t+t).map((e,i)=>a.jsx(S,{hover:!0,role:"checkbox",tabIndex:-1,children:k.map(r=>{const n=e[r.id];return a.jsx(Q,{align:r.align,children:r.id==="actions"?a.jsxs(T,{sx:{display:"flex",justifyContent:"center"},children:[a.jsx(P,{color:"primary",sx:{padding:"5px"},onClick:()=>F(e.qualificationId),children:a.jsx(se,{})}),a.jsx(P,{color:"secondary",sx:{padding:"5px"},onClick:()=>G(e.qualificationId),children:a.jsx(oe,{})})]}):n},r.id)})},i))})]})}),a.jsx(te,{rowsPerPageOptions:[5,10,25,100],component:"div",count:C.length,rowsPerPage:t,page:s,onPageChange:O,onRowsPerPageChange:$})]}),a.jsx(ie,{open:U,onClose:()=>d(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:a.jsxs("form",{onSubmit:x?H:z,children:[a.jsx(re,{id:"alert-dialog-title",children:x?"Update Qualification":"Add Qualification"}),a.jsxs(ce,{children:[a.jsx(E,{error:!!u.qualificationName,helperText:u.qualificationName,margin:"normal",id:"qualificationName",name:"qualificationName",label:"Qualification Name",type:"text",value:c.qualificationName,fullWidth:!0,onChange:v,autoFocus:!0}),a.jsx(E,{error:!!u.description,helperText:u.description,margin:"normal",id:"description",name:"description",label:"Description",type:"text",value:c.description,fullWidth:!0,onChange:v})]}),a.jsxs(ne,{children:[a.jsx(b,{variant:"contained",color:"primary",type:"submit",children:x?"Update":"Add"}),a.jsx(b,{variant:"contained",color:"secondary",onClick:()=>d(!1),children:"Cancel"})]})]})})]})};export{je as default};
